<div class="w-full" data-controller='autosubmit'>
  <div class="md:flex justify-between items-center whitespace-nowrap pb-4">
    <h1>Import Reservations from a CSV File</h1>
    <div class="flex flex-col items-center justify-center body-md-text pt-4">
      <div>
        <%= show_current_terms[0] %>
      </div>
      <div>
        <%= show_current_terms[1] %>
      </div>
    </div>
  </div>
  <div>
    <%= form_with url: import_reservations_page_path, method: :get, class: "", data: { autosubmit_target: "form", turbo_frame: "import" } do |form| %>
      <% if session[:unit_ids].count > 1 %>
        <div class="my-2">
          <label for="unit_id" class="fancy_label">Select a Unit</label>
          <%= select_tag "unit_id", options_from_collection_for_select(@units, :id, :name, selected: params[:unit_id]), include_blank: "All Units", class: "filter_select w-48",
            :"data-action" => "change->autosubmit#search" %>
        </div>
      <% else %>
        <%= form.label :unit_id, 'Unit *', class: "hidden" %>
        <input type="hidden" id="unit_id" name="unit_id" value=<%= @unit_id %>>
      <% end %>
    <% end %>
    <%= turbo_frame_tag 'import' do %>
      <div class="mt-2 body-md-text">
        <% if @unit_id.present? %>
          <p class="mb-4 body-md-text">
            This is a template of the Google Sheet file with reservations: 
            <a href="https://docs.google.com/spreadsheets/d/1NJ5VD2kPs2O3RJL6rf8oIjSvbSBmAySBzrNnCBXyyKo/copy" class="link_to" target="_blank" rel="noopener noreferrer">Google Sheet with Reservations</a>.
          </p>
          <ul class="list-disc list-outside ml-6 mb-4 space-y-1">
            <li class="ml-2">The first row provides explanations for the reservation data.</li>
            <li class="ml-2">The first row may be edited to clarify the explanations.</li>
            <li class="ml-2">The second row contains the field names and should not be edited.</li>
            <li class="ml-2">Please do not delete the first or second rows.</li>
          </ul>
          <p class="mb-4">To import reservations from this file, you will need to:</p>
          <ol class="list-decimal list-outside ml-6 mb-4 space-y-1">
            <li class="ml-2">Copy the template to edit it</li>
            <li class="ml-2">Add your reservations to the file</li>
            <li class="ml-2">Download it to your computer as a CSV file</li>
            <li class="ml-2">Choose a file and click the Import button below to upload reservations</li>
          </ol>
          <div class="d-flex flex-column flex-sm-row flex-wrap gap-2">
          <h2 class="me-5">Import Files</h2>
          <%= form_tag import_reservations_path, 
                      method: :post, 
                      data: { turbo: false },
                      multipart: true do %>
            <%= label_tag 'file', 'Choose CSV files to import:', class: 'visually-hidden' %>
            <%= file_field_tag 'file', accept: ".csv"%>
            <%= hidden_field_tag :unit_id, @unit_id %>
            <%= submit_tag 'Import', class: "secondary_blue_button" %>
          <% end %>
        </div>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
